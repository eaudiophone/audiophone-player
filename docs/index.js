(()=>{var v=Object.defineProperty,h=Object.defineProperties;var b=Object.getOwnPropertyDescriptors;var m=Object.getOwnPropertySymbols;var S=Object.prototype.hasOwnProperty,w=Object.prototype.propertyIsEnumerable;var g=(t,e,r)=>e in t?v(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,c=(t,e)=>{for(var r in e||(e={}))S.call(e,r)&&g(t,r,e[r]);if(m)for(var r of m(e))w.call(e,r)&&g(t,r,e[r]);return t},u=(t,e)=>h(t,b(e));var x=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var j=x(()=>{navigator.serviceWorker&&navigator.serviceWorker.register("./sw.js");var l=window.matchMedia("screen and (max-width: 768px)").matches?"#mobile":"#desktop",a={uploadButton:document.querySelector(l+" button#load-playlist"),inputFile:document.querySelector(l+" #upload-input"),playListData:document.querySelector(l+" #playlist #data"),inputSearch:document.querySelector(l+" #search"),player:document.querySelector(l+" footer#player"),volume:document.querySelector(l+" footer #indicator-volume"),buttonPlay:document.querySelector(l+" #play-pause"),durationTrack:document.querySelector(l+" span#duration"),timerTrack:document.querySelector(l+" span#timer"),progress:document.querySelector(l+" #progress"),nextTrack:document.querySelector(l+" #next"),prevTrack:document.querySelector(l+" #prev"),titleTrack:document.querySelector(l+" #title-track")};function P(t){return{playlist:[],selectedTrack:null,audio:null,setPlaylist:r=>t(n=>u(c({},n),{playlist:r})),setSelectedTrack:r=>t(n=>u(c({},n),{selectedTrack:r})),setAudio:({filePath:r,format:n})=>t(i=>{i.audio&&i.audio.unload();let d=i.audio=new Howl({src:[r],html5:!0,format:[n],onload:()=>{a.buttonPlay.getAttribute("value")==="play"&&a.buttonPlay.click()},onloaderror:(o,p)=>{console.error("Error al cargar el audio",r,p)},onplay:()=>{if(!a.durationTrack)return;let o=d.duration();a.durationTrack.innerHTML=k(Math.round(o)),requestAnimationFrame(f)},onend:()=>{a.buttonPlay.getAttribute("value")==="pause"&&a.buttonPlay.click(),i.selectedTrack&&i.selectedTrack.index!==i.playlist.length-1&&a.nextTrack.click()},onseek:()=>{requestAnimationFrame(f)}});return u(c({},i),{audio:d})})}}function L(t){let e=s.getState();if(e.playlist.length===0){console.error("No tracks loaded ...");return}let r=e.playlist.map(i=>i.index===t?u(c({},i),{selected:!0}):u(c({},i),{selected:!1}));e.setPlaylist(r);let n=r.find(i=>i.index===t)||null;e.setSelectedTrack(n)}async function A(){let t=await H();if(t.length===0)return;let e=s.getState();window.sessionStorage.setItem("playlist",JSON.stringify(t)),e.setPlaylist(t)}function q(t){let e=s.getState(),r=t.target.value,n=[];if(r.length===0)n=JSON.parse(window.sessionStorage.getItem("playlist")).map(i=>e.selectedTrack&&i.index===e.selectedTrack.index?u(c({},i),{selected:!0}):i);else{if(r=r.toLowerCase(),!/^[\w\s\d]{1,255}$/.test(r)){console.error(new Error("Solo caracteres alfan\xFAmericos"));return}n=e.playlist.filter(i=>i.name.toLowerCase().search(r)!==-1)}e.setPlaylist(n)}function E(){let{audio:t}=s.getState();t.stop(),a.buttonPlay.setAttribute("value","pause"),a.buttonPlay.setAttribute("src","img/play.svg"),a.buttonPlay.click()}function N(t,e){if(t.playlist===e.playlist||t.playlist.length===0)return;a.playListData.innerHTML=t.playlist.map(n=>`
            <div class="item ${n.selected?"selected":""}" track="${n.index}">
                <img src="img/play.svg" alt="play" class="icons" />
                <span>${n.name.length>35?n.name.slice(0,35)+"...":n.name}</span>
            </div>    
        `).join(""),Array.from(a.playListData.querySelectorAll(".item")).forEach(n=>n.addEventListener("click",()=>L(Number(n.getAttribute("track")))))}function $(t,e){if(t.selectedTrack!==e.selectedTrack&&a.titleTrack){if(!t.selectedTrack){a.titleTrack.innerText="No track loaded";return}t.audio&&t.audio.playing()&&E(),a.titleTrack.innerText=t.selectedTrack.name,t.setAudio({filePath:t.selectedTrack.filePath,format:t.selectedTrack.format})}}function F(t){let e=t.target,r=Number(e.value),n=Number(e.max),i=r/n*100;e.style.background=`linear-gradient(to right, var(--foreground) ${i}%, var(--borders) ${i}%)`,Howler.volume(r/100)}function M({target:t}){let{audio:e,playlist:r,selectedTrack:n}=s.getState();if(r.length===0||!n)return;let d=t.getAttribute("value");d==="pause"&&(t.setAttribute("value","play"),t.setAttribute("src","img/play.svg"),e&&e.state()==="loaded"?e.pause():e&&e.state()!=="loading"&&console.warn("No se ha cargado ning\xFAn archivo de audio o a\xFAn est\xE1 cargando.")),d==="play"&&(t.setAttribute("value","pause"),t.setAttribute("src","img/pause.svg"),e&&e.state()==="loaded"?e.play():e&&e.state()!=="loading"&&console.warn("No se ha cargado ning\xFAn archivo de audio o a\xFAn est\xE1 cargando."))}function k(t){let e=Math.floor(t/60)||0,r=t-e*60||0;return`${e}:${r<10?"0":""}${r}`}function f(){let{audio:t}=s.getState(),e=t.seek()||0;a.timerTrack&&(a.timerTrack.innerHTML=k(Math.round(e)));let r=e/t.duration()*100||0;a.progress&&(a.progress.value=r,a.progress.style.background=`linear-gradient(to right, var(--color-indicators) ${r}%, var(--borders) ${r}%)`),t.playing()&&requestAnimationFrame(f)}function T(t="next"){let{playlist:e,selectedTrack:r,audio:n,setSelectedTrack:i,setPlaylist:d}=s.getState();if(e.length===0)return;let o=r.index||0;t==="prev"&&(o=r.index-1,o<0&&(o=e.length-1)),t==="next"&&(o=r.index+1,o>=e.length&&(o=0)),n.stop(),a.buttonPlay.getAttribute("value")==="pause"&&a.buttonPlay.click(),a.progress.value=0,a.progress.style.background="var(--borders)";let p=e.map(y=>y.index===o?u(c({},y),{selected:!0}):u(c({},y),{selected:!1}));d(p),i(e[o])}function R(t){let{playlist:e,selectedTrack:r,audio:n}=s.getState();if(e.length===0||!r)return;let i=t.clientX/window.innerWidth;n.playing()&&n.seek(n.duration()*i)}async function H(){return new Promise(t=>{a.inputFile.addEventListener("input",e=>{let{files:r}=e.target,n=[];for(let i of r)n=[...n,{selected:!1,index:n.length,name:i.name||"",filePath:URL.createObjectURL(i),format:i.type.split("/")[1]}];t(n)},{once:!0}),a.inputFile.click()})}if(!a.uploadButton)return;a.uploadButton.addEventListener("click",A);if(!a.inputSearch)return;a.inputSearch.addEventListener("input",q);if(!a.volume)return;a.volume.addEventListener("input",F);if(!a.buttonPlay)return;a.buttonPlay.addEventListener("click",M);if(!a.prevTrack)return;a.prevTrack.addEventListener("click",()=>T("prev"));if(!a.nextTrack)return;a.nextTrack.addEventListener("click",()=>T("next"));if(!a.progress)return;a.progress.addEventListener("click",R);var s=zustandVanilla.createStore(P);s.subscribe(N);s.subscribe($)});j();})();
//# sourceMappingURL=index.js.map
